(e,t,"formula")?void 0!==this.formulae&&void 0!==this.formulae[e]&&void 0!==this.formulae[e][t]?(0,i.success)(this.formulae[e][t]):(0,i.success)(a.emptyRangeFormula):(0,i.failure)((0,s.unavailable)(["getCellFormula"]))}foreachNonBlankCellValue(e){return void 0===this.values||c.forEachInSparseMatrix(this.values,e,(e=>e.kind===s.OperKind.Blank))}foreachNonBlankCellFormula(e){return void 0===this.formulae||c.forEachInSparseMatrix(this.formulae,e,(e=>e.kind===a.emptyRangeFormula.kind&&e.formulaBarText===a.emptyRangeFormula.formulaBarText))}isAvailable(e,t,n){let r;switch(n){case"value":r=this.valueAvailabilitySet;break;case"formula":r=this.formulaAvailabilitySet;break;case"format":r=this.formatAvailabilitySet;break;default:(0,i.assertNever)("isAvailable",n)}