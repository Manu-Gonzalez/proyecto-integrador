es,this.usage,e));case m.TermKind.CallMachine:return(0,d.machineCall)(e.data.machine)}return e}funcContextResultToTerm(e){return(0,i.assertTrue)("calc.runtime.FunctionDispatcher.funcContextResultToTerm",void 0!==this.internalSource),(0,d.isMachineCall)(e)?(0,m.callFirstOrderFuncTerm)(this.internalSource,this.caller,(0,m.callMachineTerm)(e.machine,S.internalPosition)):e}dispatchFunction(e,t,n,o){if(!(0,r.isValidArgsLength)(t,o.length)){const n=JSON.stringify(t),r=`calc.runtime.FunctionDispatcher.dispatchFunction: bad application of ${JSON.stringify(e)} to ${o.length} arguments, ftype = ${n}`;return(0,i.assertFalse)(r)}const s=o.length;let a=r.SignatureType.None;for(let e=0;e<s;e+=1){const n=o[e],i=n.kind,l=(0,r.getArgType)(t,e,s);0==(i&l)&&(a|=i),(0,r.isRangeOper)(n)&&0==(t.flags&r.FunctionFlags.Allow3dRef)&&0==(l&r.SignatureType.Ref3D)&&!(0,r.isSheetIndex)(n.sheets)&&(a|=i),(0,r.isStringOper)(n)&&0==(t.flags&r.FunctionFlags.AllowLStrs)&&n.value.length>255&&(a|=i)}if(a===r.SignatureType.None)return this.applyOperatorOrFunction(e,o,n);if(0!=(a&r.OperKind.Array)){const n=n=>{const i=this.makeChildDispatcher(this.caller);return i.termToFuncResult(i.dispatchF