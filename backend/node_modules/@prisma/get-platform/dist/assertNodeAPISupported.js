:void 0}),!0))),this.recalcDirty=(0,o.exceptProduct)(this.recalcDirty,(0,c.createCellSetFromRange)(e))}setClientContents(e,t){this.clientContents=e}setClientValue(e,t,n){let{values:i}=this.clientContents;(0,s.forEachCellInRange)(e,((e,n,r)=>(i=i.setValue(e,{oper:u(t)?t[n][r]:t,failure:void 0}),!0))),this.setClientContents({...this.clientContents,values:i},n)}setClientFormula(e,t,n,i){let{formulae:r}=this.clientContents;r=b(r,e),void 0!==t?r=r.setValue(t,n):(0,s.forEachCellInRange)(e,(e=>(r=r.setValue(e,n),!0))),this.setClientContents({...this.clientContents,formulae:r},i)}setClientFormat(e,t,n){let{formats:i}=this.clientContents;(0,s.forEachCellInRange)(e,(e=>(i=i.setValue(e,t),!0))),this.setClientContents({...this.clientContents,formats:i},n)}getRecalcValues(e){const{row:n,col:r,rows:o,cols:s}=e,a=new Array(o);for(let e=0;e<o;e+=1)a[e]=(0,i.arrayFill)(new Array(s),t.blankGridValue);return this.recalcValues.forEachLe(e,((e,t)=>(a[e.row-n][e.col-r]=t,!0))),a}forEachRecalcValue(e,t){return this.recalcValues.forEachMeets(e,t)}getClientValue(e){return this.clientContents.values.getValue(e)??t.blankGridValue}getServerValue(e){return t