it=(e,t)=>{const[n,o,s,a,l,c]=t,u=n.value;if(0===u.length)return r.valueErrorOper;let d=b(e,o,!0);if(!Array.isArray(d))return d;let h=b(e,s,!0);if(!Array.isArray(h))return h;const g=void 0!==a&&!(0,r.isMissingOper)(a)&&a.value;let m;if(void 0===l||(0,r.isMissingOper)(l))m=!1;else{const t=e.mathpack.lfix(l);if(0!==t&&1!==t)return r.valueErrorOper;m=1===t}const p=void 0===c||(0,r.isMissingOper)(c)?r.naErrorOper:c;if((0,r.isArrayOper)(p))return r.valueErrorOper;let f=u;if(m&&(f=u.toLowerCase(),d=d.map((e=>e.toLowerCase())),h=h.map((e=>e.toLowerCase()))),0===d.length&&0===h.length)return r.valueErrorOper;const v=function(e,t,n,o,s){let a=0,l=0;const c=[];let u;for(;a<=t.length;){let d,h;if(l<t.length&&(d=y(t,l,n),h=void 0===d?y(t,l,o):void 0),(0,i.assertTrue)("calc.runtime.textsplit: current in bounds",l<=t.length),void 0!==d||void 0!==h||l===t.length){(l-a>0||!s)&&(void 0===u&&(u=[],c.push(u)),u.push((0,r.stringOper)(e.slice(a,l))),void 0!==h&&(u=void 0));const t=(d??h??"1").length;(0,i.assertTrue)("calc.runtime.textsplit: matchLength > 0",t>0),l+=t,a=l}else++l}return c}(u,f,d,h,g);if(!Array.isArray(v))return v;if(0===v.length)return r.calcErrorOper;const S=v.reduce(((e,t)=>(0,i.fastMax)(t.length,e)),0);return(0,i.assertTrue)("calc.runtime.textsplit: non-zero cols",S>0),(0,r.arrayOper)(v.length,S,v.map((e=>{for(;e.length<S;)e.push(p);return e})))},function(e){e[e.TEXTBEFORE=1]="TEXTBEFORE",e[e.TEXTAFTER=2]="TEXTAFTER"}(C||(C={})),t.textBefore=(e,t)=>{const[n,i,r,o,s,a]=t;return S(C.TEXTBEFORE,e,n,i,r,o,s,a)},t.textAfter=(e,t)=>{const[n,i,r,o,s,a]=t;return S(C.TEXTAFTER,e,n,i,r,o,s,a)}},17336:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArraySlicer=t.RangeSlicer=t.atpm1904to1900Days=t.assertError=t.assertString=t.assertNumber=void 0,t.wrap1=function(e){return(t,n)=>e(t)(n[0])},t.wrap2=function(e){return(t,n)=>e(t)(n[0],n[1])},t.chkNumOper=a,t.chkDateOper=function(e,n){let i=a(e,n);if((0,r.isErrorOper)(i))return i;const o=e.mathpack;return o.cond(i)<0?r.numErrorOper:(i=o.floor(i),h(e,i)?(e.config.date1904&&!(0,r.isStringOper)(n)&&(i=o.add(o.fromNumber(t.atpm1904to1900Days),i)),i):r.numErrorOper)},t.chkNumMultiOper=function e(t,n){switch(n.kind){case r.OperKind.Number:return(0,i.success)(new i.StrictSparseArray2D(1,1,1,1,[[n]],r.blankOper));case r.OperKind.String:const o=t.coerceOper(n,r.OperKind.Number);return(0,r.isErrorOper)(o)?(0,i.failure)(r.valueErrorOper):(0,i.success)(new i.StrictSparseArray2D(1,1,1,1,[[o]],r.blankOper));case r.OperKind.Blank:return(0,i.success)(new i.StrictSparseArray2D(1,1,1,1,[[t.mathpack.zero]],r.blankOper));case r.OperKind.Missing:return(0,i.failure)(r.naErrorOper);case r.OperKind.Error:return(0,i.failure)(n);case r.OperKind.Range:return e(t,(0,s.refToVal)(t,n,!1));case r.OperKind.Array:return(0,i.success)(new i.StrictSparseArray2D(n.rows,n.cols,n.rows,n.cols,n.opers,r.blankOper));default:return(0,i.failure)(r.valueErrorOper)}},t.validDateRange=h,t.numMod=function(e,t,n){const i=e.div(t,n);if((0,r.isErrorOper)(i))return i;const o=e.mul(e.trunc(i),n);if((0,r.isErrorOper)(o))return o;const s=e.sub(t,o);return!(0,r.isErrorOper)(s)&&e.cond(t)<0?e.abs(s):s},t.numInt=function(e,t){const n=e.sub(e.trunc(t),t);return(0,r.isNumberOper)(n)&&0===e.cond(n)},t.validateArraySize=function(e,t){if(e*t>1048576)return(0,o.throwEvaluationError)((0,r.notImplemented)(["Very large array size"]))},t.makeSlicer=function(e){return(0,r.isArrayOper)(e)?new m(e):new g(e)},t.rangeOrArrayToVal=function(e,t){return(0,r.isRangeOper)(e)?e.ranges.length>1?t:((0,i.assertTrue)("calc.funcs.rangeOrArrayToVal: not 3D ref",(0,r.isSheetIndex)(e.sheets)),e):e},t.getAbsoluteIndex=function(e,t){return(0,i.assertTrue)("calc.funcs.getAbsoluteIndex",(0,i.isInteger)(t)&&0!==t&&t<=e&&t>=-e),t>0?t-1:e+t};const i=n(11955),r=n(69698),o=n(13182),s=n(17112);function a(e,t){const n=(0,s.refToVal)(e,t,!1),o=(0,r.isRichOper)(n)?n.getFallback():n;switch(o.kind){case r.OperKind.Number:return o;case r.OperKind.Boolean:return r.valueErrorOper;case r.OperKind.String:const t=e.coerceOper(o,r.OperKind.Number);return(0,r.isNumberOper)(t)?t:r.valueErrorOper;case r.OperKind.Error:return o;case r.OperKind.Array:return r.valueErrorOper;case r.OperKind.Missing:return r.naErrorOper;case r.OperKind.Blank:return e.mathpack.zero;default:return(0,i.assertNever)("calc.funcs.chkNumOper",o)}}t.assertNumber=e=>(0,r.isNumberOper)(e)?e:(0,i.assertFalse)("calc.funcs.assertNumber"),t.assertString=e=>(0,r.isStringOper)(e)?e:(0,i.assertFalse)("calc.funcs.assertString"),t.assertError=e=>(0,r.isErrorOper)(e)?e:(0,i.assertFalse)("calc.funcs.assertError"),t.atpm1904to1900Days=1462;const l=0,c=2958465,u=0,d=2957003;function h(e,t){let n,i;const r=e.mathpack.lfix(t);return e.config.date1904?(n=u,i=d):(n=l,i=c),r>=n&&r<=