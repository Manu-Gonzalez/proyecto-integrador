{"version":3,"file":"swc.js","sourceRoot":"","sources":["../../src/transpilers/swc.ts"],"names":[],"mappings":"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","sourcesContent":["import type * as ts from 'typescript';\nimport type * as swcWasm from '@swc/wasm';\nimport type * as swcTypes from '@swc/core';\nimport type { CreateTranspilerOptions, Transpiler } from './types';\nimport type { NodeModuleEmitKind } from '..';\nimport { getUseDefineForClassFields } from '../ts-internals';\n\ntype SwcInstance = typeof swcTypes;\nexport interface SwcTranspilerOptions extends CreateTranspilerOptions {\n  /**\n   * swc compiler to use for compilation\n   * Set to '@swc/wasm' to use swc's WASM compiler\n   * Default: '@swc/core', falling back to '@swc/wasm'\n   */\n  swc?: string | typeof swcWasm;\n}\n\nexport function create(createOptions: SwcTranspilerOptions): Transpiler {\n  const {\n    swc,\n    service: { config, projectLocalResolveHelper },\n    transpilerConfigLocalResolveHelper,\n    nodeModuleEmitKind,\n  } = createOptions;\n\n  // Load swc compiler\n  let swcInstance: SwcInstance;\n  // Used later in diagnostics; merely needs to be human-readable.\n  let swcDepName: string = 'swc';\n  if (typeof swc === 'string') {\n    swcDepName = swc;\n    swcInstance = require(transpilerConfigLocalResolveHelper(swc, true)) as SwcInstance;\n  } else if (swc == null) {\n    let swcResolved;\n    try {\n      swcDepName = '@swc/core';\n      swcResolved = transpilerConfigLocalResolveHelper(swcDepName, true);\n    } catch (e) {\n      try {\n        swcDepName = '@swc/wasm';\n        swcResolved = transpilerConfigLocalResolveHelper(swcDepName, true);\n      } catch (e) {\n        throw new Error(\n          'swc compiler requires either @swc/core or @swc/wasm to be installed as a dependency.  See https://typestrong.org/ts-node/docs/transpilers'\n        );\n      }\n    }\n    swcInstance = require(swcResolved) as SwcInstance;\n  } else {\n    swcInstance = swc as any as SwcInstance;\n  }\n\n  // Prepare SWC options derived from typescript compiler options\n  const { nonTsxOptions, tsxOptions } = createSwcOptions(config.options, nodeModuleEmitKind, swcInstance, swcDepName);\n\n  const transpile: Transpiler['transpile'] = (input, transpileOptions) => {\n    const { fileName } = transpileOptions;\n    const swcOptions = fileName.endsWith('.tsx') || fileName.endsWith('.jsx') ? tsxOptions : nonTsxOptions;\n    const { code, map } = swcInstance.transformSync(input,               „   ( ¹                  ìýXWXÇò               €   ( ¹                  4þXW0Çò               „   ( ¹                  ¸þXWÇò               €   ( ¹                  HÿXWÇò               €   ( ¹          =  èÿXWtU[W                4 YW    d†           ‡i  T        ˜zV        ¨zV¸zV            ÉxVÂ                 | YW    T†           ‡i  T        èzV        øzVzV            LyVÂ                 Ä YW    D†           ‡i  T        8zV        HzVXzV            ¸-yVÂ         (LqV    ø YW    4†        £  „  ( ÀX                  ˆYW    D‡           ‡i  T        ÌzV        ÜzVìzV            <ÉxVÂ                 ÐYW    4‡           ‡i  T        zV        ,zV<zV            dÉxVÂ                 xYW°Åò               „   ( ¹                  °YWˆÅò               „   ( ¹          ðVfW       8¦bV        üVfW   
               WfW   
               WfW   
                       ôYW Åò             Ä	 <            „‘sV‚‚                  xYWèÄò               „   ( ¹          ,WfW       Ü"[W        8WfW   
                       ¼YWÄò             Ä	 <            `’sVAA                 ÄådV            8	YW                À <              €                   d	YWÄò               €   ( ¹                  œ	YWàÃò               €   ( ¹          \WfW    
               hWfW   
               tWfW   
               €WfW   
               ŒWfW   
               ˜WfW   
               ¤WfW   
               °WfW   
                       Ô	YWøÂò              Ä <           ˜“sV         ¼WfW    
               ÈWfW   
               ÔWfW   
               àWfW   
                        
YW°Âò             Ä <          ”sV‚‚          ìWfW    
               øWfW   
               XfW   
               XfW   
               XfW   
               (XfW   
               4XfW   
               @XfW   
               LXfW    
                       ,
YWÀÁò     $        Ä <$   $   	   H•sV#         XXfW    
               dXfW   
               pXfW   
               |XfW   
               ˆXfW   
               ”XfW   
                XfW   
               ¬XfW   
               ¸XfW    
               ÄXfW$   
               ÐXfW(   
                       X
YWÜÀò     ,        Ä <,   ,      h–sVc                 „
YWÁò               €   ( ¹          èXfW    
               ôXfW   
                YfW   
               YfW   
               YfW   
               $YfW   
               0YfW   
               <YfW   
               HYfW    
               TYfW$   
               `YfW(   
               lYfW,   
               xYfW0   
               „YfW4   
               YfW8   
               œYfW<   
               ¨YfW@   
               ´YfWD   
               ÀYfWH   
               ÌYfWL   
               ØYfWP   
               äYfWT   
               ðYfWX   
               üYfW\   
               ZfW`   
                       ¼
YW˜¾ò     d        À <d   d      ì—sV$                 è
YW|¿ò               €   ( ¹           ZfW    
               ,ZfW      LcV                xYW$¿ò             Ä<         ÀšsVAA          8ZfW    
               DZfW      TYW        PZfW,      €YW        \ZfW@      ¬YW        hZfWT      xYW        tZfWh      ÜI\W        €ZfWp   
               ŒZfWt   
               ˜ZfWx   
                       ¤YW¾ò     |        À<|   |   	   8›sV#         ¤ZfW    
               °ZfW   
               ¼ZfW   
                       ÐYWø½ò             À <         XœsVaA                  üYWÔ½ò               „   ( ¹          ÔZfW    
               àZfW   
               ìZfW   
               øZfW   
               [fW   
               [fW   
               [fW   
               ([fW   
               4[fW    
                       4YWÔ¼ò     $        Ä <$   $   	   sV#         @[fW    
               L[fW   
               X[fW      LcV        d[fW   
                       `YW˜¼ò             Ä<         <žsV‚‚                  ŒYW€¼ò               „   ( ¹          |[fW       TYW        ˆ[fW(      €YW        ”[fW<   
                       ÄYW¼ò     @        À<@   @      ŸsVaA                  ðYWì»ò               „   ( ¹          ¬[fW    
               ¸[fW   
               Ä[fW   
                       (YW|»ò             Ä <         ÜŸsVaA                  TYWX»ò               „   ( ¹          Ü[fW    
               è[fW   
               ô[fW   
                       ŒYWèºò             À <           sVaA           \fW    
               \fW   
                       ¸YW”ºò             À <         0¡sVAA          \fW       LcV        $\fW   
                       äYW4ºò             À<         ¨¡sVAA          0\fW    
               <\fW   
               H\fW   
                       YW¼¹ò             À <          ¢sVaA                  <YW˜¹ò               €   ( ¹                  tYWp¹ò               €   ( ¹                  ¬YWH¹ò               „   ( ¹                  äYW ¹ò               „   ( ¹                  YWø¸ò               €   ( ¹          \fW       LcV        œ\fW   
               ¨\fW   
               ´\fW   
               À\fW   
               Ì\fW    
               Ø\fW$   
                       TYW(¸ò     (        À<(   (      ´£sVâ‚          ä\fW    
               ð\fW   
               ü\fW   
               ]fW   
               ]fW   
                       €YW¼·ò             À <         ¤¤sV¢‚           ]fW       LcV        ,]fW   
                       ¬YW€·ò             À<         d¥sVAA          8]fW       LcV        D]fW      xYW        P]fW$      ÜI\W        \]fW,   
                       ØYWð¶ò     0        Ä<0   0      Ü¥sV‚‚          h]fW       LcV        t]fW   
               €]fW   
                       YW¶ò             À<         „¦sVaA                  0YWl¶ò               €   ( ¹          ˜]fW    
               ¤]fW   
               °]fW   
               ¼]fW   
               È]fW   
               Ô]fW   
               à]fW   
               ì]fW   
               ø]fW       @YW        ^fW(      YW        ^fW@   
               ^fWD   
               (^fWH   
               4^fWL   
               @^fWP   
               L^fWT   
               X^fWX   
               d^fW\   
                       hYW”´ò     `        Ä<`   `      H§sVD
         p^fW    
               |^fW   
               ˆ^fW      LcV        ”^fW   
                ^fW   
               ¬^fW    
               ¸^fW$   
               Ä^fW(   
