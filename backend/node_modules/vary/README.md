ize-p){console.warn("Skipped loading cell data, maximum cache size %d exceeded",1e4),C=!0;break}const s=f.getRangeByIndexes(r.row,r.col,r.rows,r.cols);d.push({...e,itemLoaded:s.load(n),spillLoaded:"load"===e.spillRange||"noLoad"===e.spillRange&&t&&i.util.isGridCell(r)?(t?s.getSpillingToRangeOrNullObject():s.getSpillParentOrNullObject()).load(l):void 0}),a+=o,p+=o}try{await e.sync()}catch(e){if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.responsePayloadSizeLimitExceeded&&S>16){S=Math.max(16,Math.floor(S/8));for(const{$top:e,countLoaded:t,coordLoaded:n,...i}of r)b.push(i);for(const{itemLoaded:e,spillLoaded:t,...n}of d)y.push(n);continue}throw e}if(S=Math.min(8192,2*S),t.isCancellationRequested)return(0,o.ok)({missing:!1});if(f.isNullObject)return(0,o.ok)({missing:!0});for(const{$skip:e,$top:t,countLoaded:n,coordLoaded:o,...a}of r){if(a.collection.isNullObject)continue;const r="number"==typeof n?n:n.value;e+t<r&&b.push({...a,count:r,$skip:e+t});for(const e of o.items){const t=x(e);_=_.union(s.CellSet.from(t)),a.rangeOnly||i.util.forEachTileInRange(t,4,(e=>(y.push({type:a.type,itemRange:e,spillRange:"noLoad"}),!0)))}}0!==b.length||w||(h.subtract(_).forEachRange((e=>(i.util.forEachTileInRange(e,4,(e=>(y.push({type:Excel.SpecialCellType.constants,itemRange:e,spillRange:"noLoad"}),!0))),!0))),w=!0);for(const{itemLoaded:e,spillLoaded:t,...r}of d){const{type:o,itemRange:s}=r,a="object"==typeof r.spillRange?r.spillRange:void 0;!1===e.hasSpill||t||a?E(n,o,s,e,a??t??!1,g):i.util.forEachCellInRange(s,(e=>(y.push({type:o,itemRange:e,spillRange:"load"}),!0)))}}return(0,o.ok)({missing:!1})})),t.patchCells=(0,o.runAsTask)((async function(e,t){e.application.undoScope.open(ExcelLabsStringsManager.get(ExcelLabsStringsEnum.EditorOperation));const n=e.workbook.worksheets,i=new Map;for(const{sheetId:r,row:o,column:s,formula:a,formatString:l}of t){let t=i.get(r);void 0===t&&(t=n.getItemOrNullObject(r),i.set(r,t));const c=e.workbook.worksheets.getItemOrNullObject(r).getCell(o,s);c.formulasLocal=[[a]],null!=l&&(c.numberFormat=[[l]])}return e.application.undoScope.close(),await e.sync(),(0,o.ok)(void 0)})),t.calcCells=(0,o.runAsTask)((async function(e,t){const n=e.workbook.worksheets,i=new Map;for(const{sheetId:r,range:o}of t){let t=i.get(r);void 0===t&&(t=n.getItemOrNullObject(r),i.set(r,t));const{row:s,col:a,rows:l,cols:c}=o;e.workbook.worksheets.getItemOrNullObject(r).getRangeByIndexes(s,a,l,c).calculate()}return await e.sync(),(0,o.ok)(void 0)}))},59947:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readFilesFromSheet=t.hiddenSheetExists=t.hiddenCodeSheetId=void 0;const i=n(31339),r=n(63593);t.hiddenCodeSheetId=(0,r.truncateWorksheetName)("AFE_hi